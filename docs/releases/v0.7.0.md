# FlatWiki v0.7.0

Release-Datum: 21.02.2026

## Zusammenfassung

v0.7.0 fokussiert sich auf Kommentar-Workflows, Moderationssteuerung, Sicherheits-Härtung und Admin-Bedienbarkeit.  
Das Release bringt konfigurierbare Moderationsmodi, stärkere Anti-Spam-Mechanismen, härtere Upload-/Search-Pfade und erweiterte Admin-Werkzeuge für den sicheren Betrieb im Alltag.

## Highlights

- Kommentar-Moderation ist im Admin vollständig nutzbar (`/admin/comments`)
  - Review-Queue mit Status-Filter (`pending`, `approved`, `rejected`, `all`)
  - Bulk-Aktionen: ausgewählte Kommentare freigeben, ablehnen, löschen
  - Alle Kommentare einer Seite auf einmal löschen
- Konfigurierbare Moderations-Policy im Admin
  - `Freigabe nötig (Standard)`
  - `Trusted User automatisch`
  - `Alle automatisch`
  - Trusted-User-Liste direkt in der UI pflegbar
- Verbesserte Mention-/Reply-UX bei Kommentaren
  - `@username`-Autocomplete im Kommentarfeld
  - Klick auf `@username` im Kommentartext übernimmt die Mention direkt ins Eingabefeld
  - Reply-Shortcuts über klickbare Autoren (wenn Account aktiv)
- E-Mail-Verwaltung zentral im Admin (`/admin/mail`)
  - SMTP-Konfiguration + Testmail-Funktion
  - Runtime-SMTP-Credentials und User-E-Mails können verschlüsselt gespeichert werden
- Verbesserte Bearbeitungskonflikt-Erkennung
  - Zeitstempel-Prüfung erweitert um Fingerprint-Token auf Inhalts-/Einstellungsbasis

## Sicherheit und Härtung

- Upload-Schutz (`/uploads/*`) konsistent mit Auth/Public-Read-Zugriffslogik
- Endpoint-spezifische Rate-Limits ergänzt/verschärft
  - Kommentar erstellen/löschen
  - Uploads
  - User-Suggest
- Anti-Spam-Kontrollen für Kommentare
  - Maximalanzahl Links pro Kommentar
  - Maximalanzahl Mentions pro Kommentar
  - Duplikat-Cooldown und Mindestintervall nach Rolle
- Runtime-Settings-Schreibzugriffe sind jetzt durch Mutation-Lock serialisiert (kein paralleles Überschreiben)

## Admin und Betrieb

- Admin-Kommentaransicht zeigt aktiven Moderationsmodus inkl. Erklärung
- Bulk-Moderationsformular korrigiert (keine verschachtelten Formulare/CSRF-Konflikte)
- Audit-Log erweitert für Kommentar erstellen/löschen/review und Moderations-Settings-Änderungen

## Kompatibilität / Migration

- Keine beabsichtigten Breaking Changes für die Standard-UI-Nutzung
- Bestehende Kommentare werden beim Laden robust normalisiert (inkl. Status-Defaults)
- Neue Kommentar-Moderationssettings liegen in `data/runtime-settings.json` unter `comments`

## Empfohlene Checks nach Release

1. `/admin/comments` öffnen und Moderationsmodus + Trusted-User-Liste prüfen
2. In `/admin/mail` eine SMTP-Testmail senden
3. Kommentare mit Trusted-/Nicht-Trusted-User testen und Auto-Freigabe verifizieren
4. Mention-Klickfluss auf Artikelseite prüfen (Klick auf `@username` -> Übernahme ins Kommentarfeld)

## Tag

- `v0.7.0`
